import numpy as np
import gf256
import gf257

def getCodewords(k, codewords):
	c = codewords
	kcol = np.zeros((k,1))
	rows = [0]*k
	idx = 0
	for indx, i in enumerate(c):
		if idx == k:
			break
		if i != -1:
			kcol[idx] = i
			rows[idx] = indx
			idx += 1
	return kcol, rows

def decode(k, codewords, gf):
	a = getCodewords(k, codewords)
	c = a[0]
	rows = a[1]
	#print c
	if gf == 256:
		t = gf256.generate256(k, rows)
	else:
		t = gf257.generate257(k, rows)
	array = np.concatenate((t,c), axis=1)
	if gf == 256:
		return gf256.gauss256(array)
	else:
		return gf257.gauss257(array)

if __name__ == '__main__':
	#gf(2^8)
	# code1 = [0, 180, 253, 87, 23, 236, 165, 202, 14, 244, 13, 93, 231, 54, 117, 97, 84, 225, 86, 51]
	# k1 = 10
	# print decode(k1,code1,256)

	# code2 = [-1, 180, -1, 87, 23, -1, 165, 202, -1, 244, -1, 93, -1, 54, -1, 97, 84, 225, 86, 51]
	# k2 = 10
	# print decode(k2,code2,256)

	# code3 = [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 233, -1, 8, 135, 81, 196, 212, 33, 109, 63, 38, 226, 217, 19, 108, 89, 96, 27, 51, 207, 198, 215, 250, 82, 105, 189, 231, 185, 202, 186, 196, 1256, 232, 201, 33, 102, 227, 201, 96, 180, 101, 246, 53, 118, 138, 239, 143, 252, 131, 121, 242, 180, 91, 234, 148, 3, 191, 95, 133, 4, 135, 90, 176, 103, 135, 226, 134, 226, 3, 8, 68, 173, 1, 4, 221, 154, 160, 185, 231, 44, 83, 250, 239, 187, 48, 140, 24, 19, 198, 157]	
	# k3 = 26
	# print decode(k3,code3,256)

	# code33 = [78, 180, 14, 230, 141, 250, 69, 97, 115, 157, 70, 116, 71, 50, 228, 223, 46, 101, 222, 246, 185, 166, 145, 121, 0, 224, 33, 84, 94, 115, 5, 126, 167, 223, 226, 67, 99, 54, 177, 213, 79, 33, 203, 76, 72, 65, 61, 113, 60, 118, 139, 176, 183, 255, 167, 212, 197, 62, 195, 182, 4, 107, 219, 186, 193, 94, 143, 181, 170, 235, 60, 26, 101, 233, 181, 94, 82, 11, 12, 121, 141, 56, 48, 220, 254, 38, 78, 30, 168, 81, 115, 158, 239, 214, 29, 26, 92, 176, 8, 225, 50, 228, 237, 255, 15, 100, 171, 96, 76, 200, 80, 206, 48, 125, 215, 212, 34, 20, 25, 61, 125, 171, 50, 62, 201, 137, 36, 176, 78, 76, 97, 187, 23, 50, 121, 66, 55, 81, 145, 168, 58, 3, 107, 135, 14, 237, 252, 19, 241, 17, 129, 28, 108, 80, 113, 202, 173, 179, 35, 199, 236, 103, 206, 148, 109, 10, 22, 229, 11, 159, 42, 33, 196, 51, 93, 184, 58, 87, 151, 237, 89, 84, 158, 174, 181, 119, 71, 228, 91, 174, 128, 235, 223, 251, 253, 219, 26, 161, 72, 254, 133, 134, 149, 96, 12, 236, 95, 171, 25, 63, 226, 177, 45, 101, 39, 68, 117, 5, 223, 45, 48, 93, 97, 173, 46, 154, 62, 199, 75, 91, 50, 140, 60, 110, 194, 66, 77, 196, 222, 228, 204, 144, 217, 34, 123, 159, 27, 67, 0, 215, 5, 42, 201, 150, 163]
	# k33 = 69
	# print decode(k33,code33,256)

	# #gf(257)
	#code4 = [10, 226, 208, 87, 112, 16, 169, 19, 237, 97, 115, 201, 228, 228, 239, 162, 150, 142, 48, 35, 41, 154, 8, 41, 227, 140, 235, 4, 79, 239, 180, 118, 65, 67, 250, 71, 174, 90, 226, 212, 154, 132, 78, 126, 114, 82, 244, 66, 252, 100, 228, 28, 103, 100, 33, 163, 202, 225, 138, 64, 153, 241, 133, 72, 242, 25, 210, 118, 190, 250, 43, 217, 137, 219, 171, 46, 51, 137, 237, 80, 215, 20, 181, 141, 102, 149, 200, 18, 34, 82, 19, 127, 245, 141, 236, 249, 5, 28, 159, 103, 19, 13, 107, 138, 44, 69, 25, 139, 40, 62, 34, 35, 70, 135, 73, 240, 73, 91, 230, 227, 48, 244, 159, 12, 125, 155, 209, 45, 0, 144, 142, 11, 154, 199, 249, 102, 106, 212, 181, 195, 197, 163, 208, 209, 211, 125, 52, 138, 55, 108, 95, 117, 92, 114, 106, 76, 206, 157, 227, 46, 194, 212, 121, 206, 125, 207, 115, 62, 8, 186, 240, 168, 28, 115, 202, 116, 173, 2, 53, 216, 119, 102, 56, 234, 16, 120, 53, 30, 256, 101, 39, 132, 17, 220, 213, 179, 29, 152, 82, 75, 230, 200, 170, 96, 66, 244, 23, 112, 131, 157, 46, 114, 62, 81, 192, 95, 245, 159, 23, 23, 101, 30, 71, 148, 254, 174, 183, 38, 231, 94, 61, 74, 249, 246, 52, 35, 87, 245, 107, 135, 83, 38, 162, 90, 226, 9, 206, 21, 43, 141, 50, 216, 96, 246, 197, 90]
	code4 = [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 228, 228, 239, 162, 150, 142, 48, 35, 41, 154, 8, 41, 227, 140, 235, 4, 79, 239, 180, 118, 65, 67, 250, 71, 174, 90, 226, 212, 154, 132, 78, 126, 114, 82, 244, 66, 252, 100, 228, 28, 103, 100, 33, 163, 202, 225, 138, 64, 153, 241, 133, 72, 242, 25, 210, 118, 190, 250, 43, 217, 137, 219, 171, 46, 51, 137, 237, 80, 215, 20, 181, 141, 102, 149, 200, 18, 34, 82, 19, 127, 245, 141, 236, 249, 5, 28, 159, 103, 19, 13, 107, 138, 44, 69, 25, 139, 40, 62, 34, 35, 70, 135, 73, 240, 73, 91, 230, 227, 48, 244, 159, 12, 125, 155, 209, 45, 0, 144, 142, 11, 154, 199, 249, 102, 106, 212, 181, 195, 197, 163, 208, 209, 211, 125, 52, 138, 55, 108, 95, 117, 92, 114, 106, 76, 206, 157, 227, 46, 194, 212, 121, 206, 125, 207, 115, 62, 8, 186, 240, 168, 28, 115, 202, 116, 173, 2, 53, 216, 119, 102, 56, 234, 16, 120, 53, 30, 256, 101, 39, 132, 17, 220, 213, 179, 29, 152, 82, 75, 230, 200, 170, 96, 66, 244, 23, 112, 131, 157, 46, 114, 62, 81, 192, 95, 245, 159, 23, 23, 101, 30, 71, 148, 254, 174, 183, 38, 231, 94, 61, 74, 249, 246, 52, 35, 87, 245, 107, 135, 83, 38, 162, 90, 226, 9, 206, 21, 43, 141, 50, 216, 96, 246, 197, 90]
	k4 = 10
	print len(code4)
	print decode(k4,code4,257)

	code5 = [204, 251, 98, 160, 130, 38, 158, 121, 220, 115, 37, 233, 198, 75, 195, 167, 199, 39, 24, 11, 128, 25, 4, 214, 194, 41, 135, 93, 28, 194, 217, 20, 120, 10, 78, 126, 207, 149, 235, 219, 101, 208, 232, 173, 14, 81, 6, 175, 3, 250, 176, 198, 53, 191, 99, 255, 87, 165, 114, 253, 33, 66, 66, 105, 3, 139, 31, 64, 92, 88, 205, 169, 201, 41, 34, 75, 207, 168, 130, 121, 26, 239, 253, 92, 128, 201, 11, 73, 106, 55, 97, 128, 150, 159, 17, 255, 131, 185, 8, 54, 249, 211, 158, 141, 145, 47, 61, 116, 199, 203, 134, 229, 32, 122, 133, 120, 107, 3, 218, 60, 21, 32, 47, 199, 83, 253, 67, 50, 164, 96, 108, 149, 204, 164, 56, 47, 127, 28, 106, 221, 256, 68, 57, 30, 3, 66, 118, 59, 138, 32, 45, 144, 201, 158, 43, 136, 123, 172, 136, 120, 200, 42, 202, 221, 184, 202, 69, 81, 111, 43, 233, 93, 84, 231, 133, 76, 61, 120, 126, 211, 174, 226, 90, 156, 93, 202, 130, 112, 27, 256, 99, 152, 214, 112, 169, 228, 50, 115, 125, 70, 55, 57, 234, 201, 40, 12, 214, 71, 144, 123, 218, 209, 59, 111, 200, 193, 123, 237, 115, 60, 116, 231, 211, 121, 191, 234, 112, 158, 233, 198, 193, 91, 170, 193, 43, 34, 90, 240, 177, 155, 136, 173, 214, 44, 194, 110, 13, 40, 101, 64, 158, 170, 166, 185, 149, 223]
	k5 = 26
	print len(code5)
	print decode(k5,code5,257)

	# code6 = [188, 131, 243, 69, 99, 244, 45, 47, 80, 131, 194, 37, 40, 105, 163, 135, 72, 159, 244, 51, 200, 219, 112, 6, 42, 244, 176, 124, 104, 11, 175, 194, 76, 170, 256, 39, 165, 32, 209, 220, 182, 185, 17, 70, 210, 236, 119, 161, 203, 75, 255, 217, 43, 202, 106, 246, 105, 214, 97, 214, 152, 138, 89, 2, 32, 85, 216, 46, 228, 254, 136, 226, 168, 181, 68, 173, 125, 219, 149, 188, 163, 253, 199, 20, 110, 61, 3, 72, 112, 249, 237, 165, 101, 61, 214, 208, 180, 250, 144, 151, 242, 81, 246, 61, 190, 121, 222, 96, 91, 95, 7, 16, 34, 245, 203, 94, 28, 139, 204, 93, 120, 229, 121, 231, 104, 176, 192, 47, 94, 77, 138, 188, 235, 98, 42, 43, 33, 171, 220, 24, 63, 212, 138, 221, 20, 253, 76, 213, 122, 63, 136, 247, 77, 226, 252, 160, 78, 30, 66, 126, 210, 41, 240, 8, 37, 52, 233, 77, 11, 132, 36, 112, 248, 137, 194, 17, 7, 131, 35, 125, 168, 10, 34, 151, 27, 168, 137, 81, 156, 83, 22, 85, 190, 2, 134, 74, 144, 162, 59, 158, 217, 148, 198, 178, 64, 122, 62, 60, 173, 19, 144, 254, 44, 48, 107, 236, 42, 234, 246, 212, 65, 164, 190, 110, 167, 89, 123, 142, 96, 207, 194, 70, 85, 158, 15, 148, 256, 111, 226, 26, 11, 18, 35, 17, 206, 227, 130, 39, 237, 137, 79, 78, 244, 233, 15, 19]
	# k6 = 69
	# print decode(k6,code6,257)

	# code17 = [17, 116, 104, 91, 244, 51, 243, 203, 58, 92, 107, 5, 37, 89, 44, 117, 1, 126, 211, 47, 125, 62, 93, 43, 117, 25, 243, 216, 5, 146, 112, 122, 1, 144, 183, 234, 139, 76, 99, 186, 212, 230, 220, 97, 134, 73, 186, 196, 1, 93, 234, 99, 110, 35, 137, 24, 109, 14, 41, 234, 128, 210, 152, 230, 1, 181, 177, 167, 221, 26, 207, 207, 33, 45, 73, 201, 102, 8, 136, 189, 1, 47, 146, 126, 164, 192, 17, 154, 40, 191, 230, 86, 87, 124, 5, 125, 1, 108, 220, 247, 11, 243, 42, 50, 123, 190, 209, 167, 169, 53, 135, 22, 1, 212, 54, 43, 130, 222, 168, 16, 31, 3, 59, 21, 67, 79, 129, 73, 1, 187, 32, 158, 213, 118, 236, 161, 226, 128, 42, 70, 24, 150, 41, 102, 1, 81, 159, 106, 123, 45, 65, 88, 134, 143, 139, 28, 176, 252, 148, 115, 1, 28, 63, 248, 150, 214, 149, 56, 217, 204, 197, 130, 54, 63, 187, 219, 1, 30, 223, 16, 167, 28, 35, 102, 224, 114, 116, 205, 195, 212, 63, 138, 1, 216, 219, 163, 8, 140, 164, 66, 148, 192, 227, 187, 218, 178, 92, 149, 1, 231, 82, 146, 169, 80, 109, 93, 45, 203, 89, 105, 168, 117, 39, 239, 1, 52, 229, 35, 177, 149, 201, 228, 140, 87, 216, 133, 201, 152, 184, 177, 1, 92, 246, 178, 179, 126, 171, 140, 199, 82, 125, 155, 49, 174, 98, 114]
	# k17 = 17
	# print decode(k17,code17,257)

	# code18 = [18, 92, 166, 145, 233, 58, 75, 123, 179, 15, 156, 114, 248, 165, 19, 203, 250, 61, 229, 129, 213, 6, 152, 169, 177, 127, 108, 115, 116, 52, 55, 205, 65, 150, 39, 92, 206, 10, 141, 206, 246, 185, 15, 134, 17, 54, 128, 46, 3, 45, 101, 207, 88, 49, 58, 121, 94, 117, 139, 195, 36, 105, 102, 145, 242, 51, 213, 74, 140, 171, 68, 202, 153, 249, 60, 256, 67, 77, 22, 98, 129, 59, 115, 99, 41, 60, 101, 194, 108, 101, 77, 160, 110, 86, 146, 82, 5, 12, 211, 206, 224, 14, 141, 244, 93, 139, 148, 89, 242, 100, 35, 109, 226, 209, 126, 114, 225, 255, 147, 6, 14, 154, 33, 131, 254, 217, 158, 148, 0, 211, 227, 104, 224, 111, 147, 241, 105, 205, 250, 218, 70, 74, 66, 16, 9, 146, 141, 24, 35, 101, 6, 219, 74, 41, 17, 129, 65, 89, 205, 32, 194, 22, 207, 133, 83, 23, 107, 36, 183, 249, 145, 93, 171, 82, 245, 112, 256, 78, 99, 165, 189, 14, 114, 5, 239, 11, 18, 244, 30, 60, 113, 223, 17, 89, 183, 256, 89, 252, 46, 71, 28, 245, 240, 132, 253, 109, 206, 240, 130, 219, 113, 173, 35, 212, 25, 53, 234, 36, 242, 31, 145, 155, 155, 25, 254, 148, 238, 76, 221, 121, 102, 34, 170, 138, 20, 211, 128, 105, 27, 90, 33, 95, 174, 107, 84, 93, 192, 150, 216, 188, 151, 45, 119, 36, 69, 39]
	# k18 = 18
	# print decode(k18,code18,257)